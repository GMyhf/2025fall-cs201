import pandas as pd

df = pd.read_excel('studentListInCourse-DSA-20250821.xls')
student_id = df['学号'].tolist()

sent_id = {
    2000094627, 2100011336, 2100015466, 2100017811, 2100092527, 2200010932, 2200011324, 2200011352, 2200011494, 2200011514, 
    2200011613, 2200011651, 2200011653, 2200012269, 2200012401, 2200013271, 2200013554, 2200015155, 2200015502, 2200015917, 
    2200017422, 2200019918, 2300010858, 2300011092, 2300011319, 2300011472, 2300011528, 2300011569, 2300011885, 2300012144, 
    2300012658, 2300012758, 2300013416, 2300014110, 2300014953, 2300015881, 2300017732, 2300017768, 2300093008, 2300094620, 
    2400010605, 2400010627, 2400010873, 2400011009, 2400011039, 2400011315, 2400011321, 2400011339, 2400011348, 2400011402, 
    2400011410, 2400011438, 2400011439, 2400011474, 2400011497, 2400011560, 2400011702, 2400011768, 2400011769, 2400011859, 
    2400011867, 2400012121, 2400012279, 2400012438, 2400012561, 2400012566, 2400012627, 2400012897, 2400014104, 2400015830, 
    2400016661, 2400017707, 2400017780, 2400017806, 2400017819, 2400017842, 2400092604, 2400093016, 2500011813, 2500012291, 
    2500012312, 2500012561, 2500015448, 2500015859, 2500015889, 2510301253, 2510307329
}

print(len(sent_id))

res1 = []
res2 = []
for i in student_id:
    if i in sent_id:
        continue

    res2.append(i)
    if i < 2e9:
        res1.append(f"{i}@pku.edu.cn")
    else:
        res1.append(f"{i}@stu.pku.edu.cn")

print(','.join(res1))
print(', '.join(map(str, res2)))

'''
我是mac机器，可以这样发送，但是北大邮箱总把收到的邮件归到Spam里面。
(cat mail.txt; uuencode 20230820-Wechat.jpg 20230820-Wechat.jpg)|mail -s "202308 计算概论（B）（12班）课程微信群" x@pku.edu.cn

所以我现在是程序输出要发送同学的邮箱地址列表，拷贝下来，在浏览器邮件里面发送。
'''
